# SQLite LIKE ######################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-like/

## Обзор ##############################

В этом руководстве вы изучите, как запрашивать данные, основываяь на сопостовлении с шаблоном, использую оператор SQLite `LIKE`.

## Знакомство с операторм SQLite `LIKE`

Иногда, вы не знаете точно полное ключевое слово, по которомы вы хотите запросить данные. Например, вы можете знать, что ваша самая любимая песня содержит слово `elevator`, но вы не знаете точно название.

Для того чтобы запросить данные по частичной информации используется оператор `LIKE` в проедложении `WHERE` оператора `SELECT` как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  column_list
FROM
  table_name
WHERE
  column_1 LIKE pattern;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Обратите внимание, что вы также можете использовать оператор `LIKE` как в предложении `WHERE` так и в `DELETE` и `UPDATE`.

SQLite поддерживает два подстановочного символа для создания шаблонов. Это знак процента `%` и нижнего подчеркивания `_`:

1. Знак процента `%` сопоставляет любую последовательность из нуля и более символов.

2. Знак нижнего подчеркивания `_` сопоставляет любой отдельный символ.

## Примеры подстановочного символа `%`

Шаблон `s%` который использует символ процента `%` соответствует любой строке, которая начинается с `s`, например, `son` и `so`.

Шаблон `%er` соответствует любой строке, которая оканчивается на `er`, например, `peter`, `clever`, и т.д.

И шаблон `%per%` соответствует любой строке, которая содержит `per`, такие как `percent` и `peeper`.

## Примеры подстановочного символа `_`

Шаблон `h_nt` соответствует `hunt`, `hint`, и т.п. Шаблон `__pple` соответствует `toople`, `supple`, `tipple`, и т.п.

Обратите внимание, что оператор SQLite `LIKE` регистронезависимый. Это значит, что `"A" LIKE "a"` равно `true`.

Однако для символов `Unicode`, которые не входят в диапазон `ANCII`, оператор `LIKE` чувствителен к регистру, например `"Ä" LIKE "ä"` будет `false`.

В случае, если вы хотите, чтобы оператор `LIKE` работал в режите чувствительности к регистру, вы должны использовать оператор `PRAGMA`, как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PRAGMA case_sensitive_like = true;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Примеры оператора SQLite `LIKE`

Для демонстрации будем использовать таблицу `tracks` тестовой базаы данных.

|   tracks       |
|----------------|
| * Tracked      |
|   Name         |
|   AlbumId      |
|   MediaTypeId  |
|   GenderId     |
|   Composer     |
|   Milliseconds |
|   Bytes        |
|   UnitPrice    |

Чтобы найти треки, которые начинаются с литерала `Wild`, используется знак `%` в конце шаблона.

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  trackId,
  name
FROM
  tracks
WHERE
  name LIKE 'Wild%';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы найти треки, чьи имена оканчиваются на `Wild`, используется знак `%` вначале шаблона.

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  trackId,
  name
FROM
  tracks
WHERE
  name LIKE '%Wild';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы найти терки, чьи имена содержат литерал `Wild` используется знак `%` вначале и в конце:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  trackId,
  name
FROM
  tracks
WHERE
  name LIKE '%Wild%';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Следующее выражение находит треки, чьи имена содержат: ноль или более символов (`%`), затем `Br`, любой символ (_), затем `wn`, и затем ноль или более символов (`%`).

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  trackId,
  name
FROM
  tracks
WHERE
  name LIKE '%Br_wn%';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Оператор SQLite `LIKE` с предложением `ESCAPE`

Если шаблон, по которому вы хотите искать, содержит `%` или `_`, вы можете использовать экранирующие символы в необязательном предложении `ESCAPE`, как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
column_1 LIKE pattern ESCAPE expression;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Когда вы указываете предложение `ESCAPE`, оператор `LIKE` будет оценивать `expression`, которое следует за ключевым словом `ESCAPE` как строку, которая содержит единичный символ, или экранирующий символ.

Затем, вы можете использовать экранирующий символ в шаблоне, чтобы добавить литерал знака процента `%` или нижнего подчеркивания `_`. Оператор `LIKE` интерпретирует знак процента `%` или нижнего подчеркивания `_`, слудующий за экранирующим символом, как литерал, а не символ подстановки.

Предположим, вы хотите найти строку `10%` в столбце таблицы. Несмотря на то, что SQLite интерпретирует знак процента `%`, как символ подстановки. Следовательно, вы должны экранировать этот символ процента `%` используя экранирующий символ:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
column_1 LIKE '%10\%%' ESCAPE '\';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

В этом выражении, оператор `LIKE` интерпретирует первый `%` и последний `%` как символы подстановки и второй знак процента, как литерал.

Обратите внимание, что вы можете использовать другие символы в качестве экранирующего символа, например, `/`, `@`, `$`.

Посмотрите следующий пример:

Для начала, создадим таблицу `t`, которая имеет одну колонку:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE t(
  c TEXT
);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Затем, вставим в таблицу `t` несколько строк:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INSERT INTO t(c)
VALUES
  ('10% increase'),
  ('10 times dacrease'),
  ('100% vs. last year'),
  ('20% increase next year');
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Затем, выберем данные из таблицы `t`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT * FROM t;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

В четвертых, попробуем найти строки, чьи значения столбца `c` содержат литерал `10%`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT c
FROM t
WHERE c LIKE '%10%%';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Однако, он возвращает строки, чьи значения содержат `10`.

В пяных, чтобы получить корректный результат, используем предложение `ESCAPE` как показано в запросе ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT c
FROM t
WHERE c LIKE '%10\%%' ESCAPE '\';
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

В этом руководстве, вы изучили, как использовать оператор SQLite `LIKE` для запроса данных из БД по шаблону соответствия, используя два символа подстановки `%` и `_`.

Предидущее руководство < [SQLite IN][prev]  
Следующее руководство > [SQLite GLOB][next]

[prev]: ../07_In/translate.md
[next]: ../09_Glob/translate.md