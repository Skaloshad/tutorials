# SQLite ORDER BY #####################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-order-by/

## Обзор ##############################

В этом руководстве вы изучите, как сортировать результирующий набор запроса, используя предложение SQLite `ORDER BY`.

## Знакомство с предложением SQLite `ORDER BY` 

SQLite хранит данные в таблицах а неопределенном порядке. Это означает, что строки в таблице могуть быть, а могут и не быть в порядке, в котором они были вставлены.

Если вы используете оператор `SELECT` для выбора данных из таблицы, порядок строк в результирующем наборе будет неопределенным.

Для сортировки результирующего набора, вы должны добавить предложение `ORDER BY` в оператор `SELECT`, как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  select_list
FROM
  table
ORDER BY
  column_1 ASC,
  column_2 DESC;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Предложение `ORDER BY` следует после предложения `FROM`. Оно позволяет вам сортировать результирующий набор в порядке возрастания или убывания, основываясь на одном или нескольких столбцах.

В данном синтаксисе, после предложения `ORDER BY`, вы размещаете название столбца, по которому хотите отсортировать, за которым следует ключевое слово `ASC` или `DESC`.

- Ключевое слово `ASC` означет - по возрастанию (*от сл. ascending*)
- Ключевое слово `DESC` означает - по убыванию (*от сл. descending*)

Если вы не укажите ключевое слово `ASC` или `DESC`, SQLite отсортирует результирующий набор используя параметр `ASC`. Другими словами, он сортирует результирующий набор в порядке возрастания по умолчанию.

В случае, когда вы хотите отсортировать результирующий набор по нескольким столбцам, используйте запятую`,` для разделения двух стобцов. Предложение `ORDER BY` сортирует строки, использую столбци или выражения слева направо. Другими словами, предложение `ORDER BY` сортирует строки используя первый столбец в списке. Затем оно сортирует отсортированые строки, используя второй столбец, и так далее.

Вы можете отсортировать результирующий набор, используя столбец, который не фигурирует в списке выбора оператора `SELECT`.

## Примеры предложения SQLite ORDER BY 

Давайте возмем таблицу `tracks` из образца БД для демонстрации.

|   tracks       |
|----------------|
| * Tracked      |
|   Name         |
|   AlbumId      |
|   MediaTypeId  |
|   GenderId     |
|   Composer     |
|   Milliseconds |
|   Bytes        |
|   UnitPrice    |

Предположим, что вы хотите получить данные из колонок - `name`, `milliseconds` и `albumID`, используя следующее выражение:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  name,
  milliseconds,
  albumId
FROM
  tracks;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Выражение `SELECT` не сипользует предложение `ORDER BY` и возвращает результирующий набор, который никак не упорядочен.

Предположим, что вы хотите отсортировать результирующий набор по колонке `albumId` в порядке возрастания - используйте следующее выражение:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  name,
  milliseconds,
  albumId
FROM
  tracks
ORDER BY
  albumId ASC;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Результирующий набор отсортировался по колонке `albumId` в порядке возрастания.

SQLite использует `ASC` по умолчанию, так что вы можете пренебреч им, как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  name,
  milliseconds,
  albumId
FROM
  tracks
ORDER BY
  albumId;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Предположим, что вы хотите отсортировать по полю `milliseconds` в порядке убывания поверх отсортированного результата (по полю `albunId`). В этом случае, вы должны добавить колонку `milliseconds` в предложение `ORDER BY` как показано ниже.

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  name,
  milliseconds,
  albumId
FROM
  tracks
ORDER BY
  albumId ASC,
  milliseconds DESC;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Сначала SQLite сортирует строки по полю `albumId` в порядке возрастания. Затем, он сортирует результирующий набор по полю `milliseconds` в порядке убывания.

Если вы посмотрите на треки у которых `albumId` 1, вы увидите, что порядок треков меняется между двумя выражениями.

## SQLite ORDER BY по позиции столбца #

Вместо определения имен столбцов в предложении `ORDER BY`, вы можете использовать номер позиции колонки.

Например, следующее выражение сортирует треки по обоим колонкам `albumId` (3ий столбец) и `milliseconds` (2й столбец) в порядке возрастания.

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  name,
  milliseconds,
  albumId
FROM
  tracks
ORDER BY
  3, 2;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Числа 3 и 2 ссылаются на `albumId` и `milliseconds` в списке столбцов, которые фигурируют в предложении `SELECT`.

## Сортировка NULLей ##################

В мире баз данныйх значение NULL является особенным. Оно означает, что информация отсутствует или данные не подходят.

Предположим, что вы хотите сохранить День рождения артиста в таблице. На момент сохранения записи об артисте вы не имеете о нем инфрмации.

Для представления отсутствующей информации о дне рождения в базе данных, вы можете использовать специальную дату, наподобии `01.01.1900` или пустую строку `''`. Однако оба эти значения явно не указывают на то, что день рожденя неизвестен. 

`NULL` был изобретен для решения этой проблемы. Вместо использования специального значения, для отображения отсутствующей информации, используется `NULL`.

Значение `NULL` является особенным, потому что вы не можете сравнить его с другим значением. Проще говоря, если обе части инфрмации являются неизвестными, вы не можете их сравнить.

Также, значение `NULL` не может быть сравнено с самим собой; `NULL` не равен самому себе, так что `NULL = NULL` всегда вернет `false`.

Когда дело доходит до сортировки, SQLite считает `NULL` мнеьше, чем любое другое значение.

Это означает, что `NULL`s будут появлятся в начале результирующего набора, если используется `ASC` или в конце, если используется `DESC`.

В SQLite 3.30.0 в выражение `ORDER BY` добавлены параметры `NULLS FIRST` и  `NULLS LAST`. Параметр `NULLS FIRST` указывает на то, что `NULL`s должны появлятся в начале результирующего набора, тогда как параметр `NULLS LAST` помещает `NULL`s в конец.

Слудующий пример использует предложение `ORDER BY` чтобы отсортировать треки по композитору:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  trackId,
  name,
  composer
FROM
  tracks
ORDER BY
  composer;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Во-первых, вы видите, что `NULL`s появляются в начале результирующего списка, потому, что SQLite рассматривает их как наименьшие значения. Когда вы прокрутите результат вниз, вы увидите остальные значения.

Следующий пример использует параметр `NULLS LAST` чтобы поместить `NULL`ы после остальных значений: 

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
  trackId,
  name,
  composer
FROM
  tracks
ORDER BY
  composer NULLS LAST;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Елси вы прокрутите вывод вниз, вы увидите, что `NULL`ы помещены а конец результирующего набора.

В этом руководстве вы изучили, как использовать предложение SQLite `ORDER BY` для сортировки результирующего набора по одному или нескольким столбцам, по возрастанию и по убыванию.

Предидущее руководство < [SQLite SELECT][prev]  
Следующее руководство > [SQLite SELECT DISTINCT][next]

[prev]: ../01_Select/translate.md
[next]: ../03_SelectDistinct/translate.md