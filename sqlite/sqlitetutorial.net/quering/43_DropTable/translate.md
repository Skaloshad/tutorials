# SQLite DROP TABLE #########################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-drop-table/

## Обзор ##############################

В этом руководстве вы узнаете, как удалить таблицу с помощью выражения `DROP TABLE`.

## Знакомство с выражением SQLite `DROP TABLE`

Для удаления таблицы из базы данных используется выражение `DROP TABLE`. Это простое выражение показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
DROP TABLE [IF EXISTS] [schema_name.]table_name;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Здесть вы указываете название таблицы, которую хотите удалить после ключевого слова `DROP TABEL`.

SQLite позволяет вам удалять только одно таблицу в единицу времени. Для удаления нескольких таблиц вы должны использовать несколько выражений `DROP TABLE`.

Если вы удаляете не существующую таблицу SQLite выдаст ошибку. Если вы используете опцию `IF EXISTS` SQLite удалит таблицу только если она существует, в противно случае не сделает ничего.

Если вы хотите удалить таблицу в указанной базе данных, явно задайте схему через `[schema_name.]`.

В случае когда таблица имеет зависимые объекты, такие как триггеры и индексы, выражение `DROP TABLE` также удалит все зависимые объекты.

Выражение `DROP TABLE` перед удалением таблицы неявно выполняет выражение `DELETE`. Однако, выражение `DROP TABLE` удаляет триггеры, связанные с таблицей, раньше, чем неявное выполнение `DELETE`, поэтому триггер удаления не сработает.

Если проверка внешнего ключа включена и вы выполняете выражение `DROP TABLE`, перед тем, как выполнить неявный `DELETE` SQLite выполнит проверку ограничения внешнего ключа. Если ограничение внешнего улюча будет нарушено, SQLite выдаст ошибку и удаление таблицы не будет произведено.

> Обратите внимание на то, что выражение `DROP TABLE` удаляет таблицу из базы данных и из файла с диска совсем. Вы не сможете отменить или восстановить удаление этого действия. Поэтому будте придельно осторожны во время выполнения `DROP TABLE`.

## Примеры выражения SQLite `DROP TABLE`

Для демонстрации создадим две таблицы: `people` и `addresses`. Каждая персона имеет один адрес. И один адрес может принадлежать нескольким людям.

1. Создадим таблицы:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE IF NOT EXISTS people (
  personId INTEGER PRIMARY KEY,
  firstName TEXT,
  lastName TEXT,
  addressId INTEGER,
  FOREIGN KEY (addressId)
    REFERENCES addresses (addressId)
);

CREATE TABLE IF NOT EXISTS addresses (
  addressId INTEGER PRIMARY KEY,
  houseNo TEXT,
  street TEXT,
  city TEXT,
  postalCode TEXT,
  country TEXT
);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

![tables]

2. Вставим адрес и персону в таблицы:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INSERT INTO addresses (houseNo, street, city, postalCode, country)
VALUES ('3960', 'North 1st Street', 'San Jose', '95134', 'USA');

INSERT INTO people (firstName, lastName, addressId)
VALUES ('John', 'Doe', 1);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

3. Используем выражение `DROP TABLE`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
DROP TABLE addresses;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SQLite выдаст сообщение об ошибке.

Это произошло из-за нарушения ограничения внешнего ключа.

Для удаления таблицы `addresses` вам нужно:

1. Отключить проверку ограничения внешнего ключа.
2. Удалить (`DROP`) таблицу `addresses`.
3. Обновить значения `addressId` таблицы `people` на значения `NULL`.
4. Включить ограничение внешнего ключа.

Посмотрите следующее выражение:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PRAGMA foreign_keys = OFF;

DROP TABLE addresses;

UPDATE people
SET addressId = NULL;

PRAGMA foreign_keys = ON;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Таблица `addresses` удалена и значения столб `addressId` обновлены на значение `NULL`.

---------------------------------------

Предидущее руководство < [SQLite RANAME COLUMN][prev]  
Следующее руководство > [SQLite GENERATED COLUMNS][next]

[prev]: ../42_RenameColumn/translate.md
[next]: ../44_GeneratedColumns/translate.md

[tables]: ./SQLite-DROP-TABLE-example.png