# SQLite CREATE VIEW #########################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-create-view/

## Обзор ##############################

В этом руководстве вы узнаете, как использовать выражение `CREATE VIEW` для создания нового представления в базе данных.

## Что такое представление

В теории баз данных, представление - это результирующий набор сохраненного запроса. Представление, это способ упаковать запрос в именованный объект базы данных, хранимый в БД.

Вы можете получить даступ к таблицам через представление. Таблицы, на которые ссылаются в представлении, называются базовыми табилцами.

Представление полезны в следующих случаях:

- Представления предоставляют уровень абстракции над таблицами. Вы можете добавлять и удалять столбцы в представлении без взаимодействия со схемой используемых таблиц.

- Вы можете использовать представления для инкапсуляции сложных запросов с объединениями для упрощения доступа к данным.

Представления SQLite имеют ограничение только для чтения. Это означает, что вы не можете вставлять, удалять, или изменять данные в таблицах через представление.

## Выражение SQLite `CREATE VIEW`

Для создания представления используется выражение `CREATE VIEW`, как показано ниже:

``````````````````````````````````` sql
CREATE [TEMP] VIEW [IF NOT EXISTS] view_name[(column-name-list)]
AS select-statement;
```````````````````````````````````````

1. Укажите название представления. Опция `IF NOT EXISTS` создает представление только в том случае, если оно еще не существует. Если представление существуею, то выражение не делает ничего.

2. Используйте опции `TEMP` или `TEMPORARY` если хотите, чтобы представление было видимым только для текущего соединения с базой данных. Такое представление называется временным, и SQLite автоматически удаляет временные представления когда соединение с базой данных закрывается.

3. Укажите выражение `SELECT` для представления. По умолчанию, столюцы представления выводятся из результирующего набора выражения `SELECT`. Однако вы можете указать названия столбцов представления, которые будут отличаться от названий из таблицы.

## Примеры SQLite `CREATE VIEW`

Давайте приведем несколько примеров создания нового представления используя выражение `CREATE VIEW`.

1. Создание представления для упрощения сложного запроса

Следующий запрос берет данные из таблиц `tracks`, `albums`, `media_types` и `genres` в БД используя выражение внутреннего объединения:

``````````````````````````````````` SQL
SELECT
  trackId,
  tracks.name,
  albums.title AS album,
  media_types.name AS media,
  genres.name AS genres
FROM
  tracks
INNER JOIN albums USING (albumId)
INNER JOIN media_types USING (mediaTypeId)
INNER JOIN genres USING (genreId);
```````````````````````````````````````

Для создания представления, использующего данный запрос, используйте следующее выражение:

``````````````````````````````````` SQL
CREATE VIEW v_tracks
AS
SELECT
  trackId,
  tracks.name,
  albums.title AS album,
  media_types.name AS media,
  genres.name AS genres
FROM
  tracks
INNER JOIN albums USING (albumId)
INNER JOIN media_types USING (mediaTypeId)
INNER JOIN genres USING (genreId);
```````````````````````````````````````

С этого момента вы можете использовать следующее выражение для получения данных сложного запроса выше:

``````````````````````````````````` SQL
SELECT * FROM v_tracks;
```````````````````````````````````````

2. Создание представления с указанными именами столбцов

Слудующее выражение создает представление с именем `v_albums`, содержащее названия альбомов и продолжительность в минутах:

``````````````````````````````````` SQL
CREATE VIEW v_albums (
  albumTitle,
  minutes
)
AS
  SELECT
    albums.title,
    SUM (milliseconds) / 60000
  FROM
    tracks
  INNER JOIN albums USING (albumId)
  GROUP BY albums.title;
```````````````````````````````````````

В этом примере мы указали новые названия для столюцов представления `albumTitle` из таблицы `albums.title` и `minutes` из выражения `SUM (milliseconds) / 60000`

Для вывода результата работы представления используйте следующее выражение:

``````````````````````````````````` SQL
SELECT * FROM v_albums;
```````````````````````````````````````

---------------------------------------

Предидущее руководство < [SQLite EXPORT CSV][prev]  
Следующее руководство > [SQLite DROP VIEW][next]

[prev]: ../50_ExportCSV/translate.md
[next]: ../52_DropView/translate.md