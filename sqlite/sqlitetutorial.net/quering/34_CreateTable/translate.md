# SQLite CREATE TABLE #########################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-create-table/

## Обзор ##############################

В этом руководстве вы узнаете, как создавать новые таблицы, используя выражение SQLite `CRATE TABLE`, с использованием различных опций.

## Знакомство с выражением SQLite `CREATE TABLE`

Для создания новой таблицы в SQLite испльзуется выражение `CREATE TABLE`, как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE [IF NOT EXISTS] [schema_name].table_name (
  column_1 data_type PRIMARY KEY,
  column_2 data_type NOT NULL,
  column_3 data_type DEFAULT 0,
  table_constraints
) [WITHOUT ROWID];
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Подробнее:

- Сперва определяется название таблцы, которую вы хотите создать, оно указывается после ключегоко слова `CREATE TABLE`. Имя таблицы не может начинаться с `sqlite_` так как это является зарезервированым литералом для внутреннего использования SQLite.

- Далее, используйте опцию `IF NOT EXISTS` для создания таблицы, если она не существует. Попытка создания таблицы которая существует, без проверки на ее существование выдаст ошибку.

- Далее, вы можете указать название схемы (`schema_name`), которой будет принадлежать новая таблица. Схемой может служить основная база, временная `temp` база, или подсоединенная база.

- Далее, укажите список колонок таблицы. Каждая колонка имеет название, тип данных и ограничение. SQLite поддерживает следующие ограничения: `PRIMARY KEY`, `UNIQUE`, `NOT NULL` и `CHECK`.

- Далее, укажите ограничения таблицы, такие как `PRIMAYE KEY`, `FOREIGN KEY`, `UNIQUE` и `CHECK`.

- Наконец, вы можете указать необязательный параметр `WITHOUT ROWID`. По умолчанию, строка в таблице имеет скрытое поле, которое ссылается на столбец `rowid`, `oid` или `_rowid_`. Колонка `rowid` хранит 64х значный ключ, который является уникальным номером строки в таблице. Если вы не хотите, чтобы SQLite создавал колонку `rowid`, вы должны указать опцию `WITHOUT ROWID`. Тблица, которая имеет столбец `rowid` называется таблицей `rowid`. Обратите внимание, что опция `WITHOUT ROWID` доступна только в версии SQLite 3.8.2 или более.

> Запомните, что первичный ключ таблицы это столбец или группа столбцов, которые являются уникальным идентификатором каждой строки таблицы.

## Примеры SQLite `CREATE TABLE`

Предположим вы управляете контактами используя SQLite.

Каждый контакт имеет следующую информацию:

- First name
- Last name
- Email
- Phone

Требуется, чтобы поля email и phone были уникальными. Дополнительно, каждый контакт принадлежит одной и более группам, и каждая группа может имет ноль или более контактов.

Основываясь на этих требованиях мы можем создать три таблицы:

- Таблица `contacts`, которая хранит информацию по контактам.
- Таблица `groups`, которая хранит информацию по группам.
- Таблица `contct_groups`, которая хранит отношения между контактами и группами.

Следующая диаграмма показывает эти три таблицы:

![diagram]

Следующее выражение создает таблицу `contacts`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE contacts (
  contact_id INTEGER PRIMARY KEY,
  first_name TEXT NOT NULL,
  last_name TEXT NOT NULL,
  email TEXT NOT NULL UNIQUE,
  phone TEXT NOT NULL UNIQUE
);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

`contact_if` является первичным ключем таблицы `contacts`.

Поскольку первичный ключ состоит из одной колонки, мы используем ограничение столбца.

Колонки `first_name` и `last_name` имеют класс `TEXT` и эти колонки `NOT NULL`. Это означает, что вы должны обеспечить наличие значение, когда вы вставляете или обновляете строку в таблце `contacts`.

Колонки почты и телефона уникальные, поэтому мы используем ограничение `UNIQUE` для каждой колонки.

Следующее выражение создает таблицу `groups`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE groups (
   group_id INTEGER PRIMARY KEY,
   name TEXT NOT NULL
);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Таблица `groups` довольно проста и содержит две колонки: `group_id` и `name`. Колонка `group_id` является первичным ключем.

Следующее выражение создает таблицу `contact_groups`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE contact_groups (
  contact_id INTEGER,
  group_id INTEGER,
  PRIMARY KEY (contact_id, group_id),
  FOREIGN KEY (contact_id)
    REFERENCES contacts (contact_id)
      ON DELETE CASCADE
      ON UPDATE NO ACTION,
  FOREIGN KEY (group_id)
    REFERENCES groups (group_id)
      ON DELETE CASCADE
      ON UPDATE NO ACTION    
);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Таблица `contact_groups` имеет первичный ключ, который состоит из двух столбцов: `contact_id` и `group_id`.

Для добавления первичного ключа используется следующий синтаксис:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
PRIMARY KEY (contact_id, group_id)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Дополнительно, колонки `contact_id` и `group_id` являются внешними ключами. Исходя из этого мы используем ограничение `FOREIGN KEY` для объявления внешнего ключа для каждой колонки.

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
FOREIGN KEY (contact_id)
  REFERENCES contacts (contact_id)
    ON DELETE CASCADE
    ON UPDATE NO ACTION
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
FOREIGN KEY (group_id)
  REFERENCES groups (group_id)
    ON DELETE CASCADE
    ON UPDATE NO ACTION
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

> Обратите внимание, мы обсудим внешние улючи в следующих руководствах.

В этом руководстве вы изучили, как создать новую таблицу с разными опциями, используя выражение SQLite `CREATE TABLE`.

---------------------------------------

Предидущее руководство < [SQLite ATTACH DATABASE][prev]  
Следующее руководство > [SQLite AUTOINCREMENT][next]

[prev]: ../33_AttachDatabase/translate.md
[next]: ../35_Autoincrement/translate.md

[diagram]: ./SQLite-CREATE-TABLE-example.jpg