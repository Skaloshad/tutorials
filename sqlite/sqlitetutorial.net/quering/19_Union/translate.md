# SQLite UNION ######################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-union/

## Обзор ##############################

В этом руководстве вы изучите, как использовать оператор SQLite `UNION` для комбинации результатов двух и более запросов в один результирующий набор.

## Знакомство с оператором SQLite `UNION`

Иногда вам нужно комбинировать данные из нескольких таблиц в один полный результирующий набор. Это может применятся для таблиц с схожими данными в одной и той же базе данных, или, может быть вам нужно скомбинировать схожие данные из нескольких баз данных.

Для камбинации строк из двух и более запросов в единый результирующий набор, используется оператор SQLite `UNION`. Ниже приведен синтаксис оператора `UNION`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
query_1
UNION [ALL]
query_2
UNION [ALL]
query_3
...;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Оба оператора `UNION` и `UNION ALL` комбинируют строки в единый результирующий набор. Оператор `UNION` удаляет дубликаты строк, тогда как `UNION ALL` не делает этого.

Из-за того, что `UNION ALL` не удаляет дубликаты строк, он работает быстрее оператора `UNION`.

Ниже приведены правила объединения данных:

- Количество столбцов во всех запросах должно быть одинаковыь.

- Сопоставляемые столбцы должны иметь совместимые типы данных.

- Имена стобцов первого запроса определяют имена столбцов конечного результирующего набора.

- Предложения `GROUP BY` и `HAVING` применяются для каждого индивидуального запроса, а не для конечного результирующего набора.

- Предложение `ORDER BY` применяется к конечному результирующему набору, а не внутри каждого конкретного набора.

Предположим, что мы имеем две таблицы `t1` и `t2` следующей структыры:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE TABLE t1 (
  v1 INT
);

INSERT INTO t1 (v1)
VALUES (1), (2), (3);

CREATE TABLE t2 (
  v2 INT
);

INSERT INTO t2 (v2)
VALUES (2), (3), (4);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Следующее выражение комбинирует результаты из таблиц `t1` и `t2` используя оператор `UNION`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT v1
FROM t1
UNION
SELECT v2
FROM t2;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Следующее изображение иллюстрирует операцию `UNION` с двумя таблицами `t1` и `t2`:

![union][]

Следующее выражение комбинирует строки таблиц `t1` и `t2` используя `UNION ALL`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT v1
FROM t1
UNION ALL
SELECT v2
FROM t2;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Следующее изображение иллюстрирует операцию `UNION ALL` с двумя таблицами `t1` и `t2`:

![union-all][]

## Примеры SQLite `UNION`

Давайте приведем несколько примеров использования оператора `UNION`.

### 1) SQLite `UNION`

Это выражение использует оператор `UNION` для комбинации имен сотрудников и потребителей в единый список:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT firstName, lastName, 'Employee' AS type
FROM employees
UNION
SELECT firstName, lastName, 'Customer'
FROM customers;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### 2) SQLite `UNION` с `ORDER BY`

Этот пример использует оператор `UNION` для комбинирования имен сотрудников и потребителей в единый список. Дополнительно, в нем используется предложение `ORDER BY` для сортировки списка имен по имени и фамилии.

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT firstName, lastName, 'Employee' AS type
FROM employees
UNION
SELECT firstName, lastName, 'Customer'
FROM customers
ORDER BY firstName, lastName;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

В этом руководстве вы изучили, как использовать оператор SQLite `UNION` для комбинации строк результатов в единый результирующий набор. Вы также изучили разницу между `UNION` и `UNION ALL`.

Предидущее руководство < [SQLite HAVING][prev]  
Следующее руководство > [SQLite EXCEPT][next]

[prev]: ../18_Having/translate.md
[next]: ../20_Except/translate.md

[union]: ./SQLite-UNION.png
[union-all]: ./SQLite-UNION-ALL.png