# SQLite INDEX #########################

[Файл с запросами][querys]   
[Оригинальная статья][origin]

[querys]: ./querys.sql
[origin]: https://www.sqlitetutorial.net/sqlite-index/

## Обзор ##############################

В этом руководстве вы узнаете, как использовать SQLite индексы для ускорения запросов, ускорения сортировки и применять уникальные ограничения.

## Что такое Индекс?

В реляционных базах данных, таблицы это набор строк. В то же время, каждая строка имеет структуру столбцов, которые образуют ячейки. Каждая строка также имеет последовательный rowid, который используется для идентификации строк. Таким образом, вы можете представить таблицу как список пар ключ-значение: (rowid, строка).

В отличии от таблицы, индекс имеет противоположное отношение: (строка, rowid). Индекс это дополнительная структура, которая помогает повысить производительность запроса.

![index]

SQLite использует Б-дерево для организации индекса. 

> Обратите внимание, что **Б** это не бинарное, а сбалансированое дерево.

В Б-дереве, все данные расположены по обе стороны дерева (сбалансированы), таким образом, чтобы количество уровней дерева, всегда было примерно одинаковым числом. В дополнение, запросы использующие равенстао (=) и диапазоны (<,>=,<,<=) очень эффуктивны.

## Как работает индекс

Каждый индекс должен быть отнесен к определенной таблице. Индекс может быть составлен из одного или нескольких столбцов, но все столбцы должны быть из одной и тойже таблицы. Таблица может иметь несколько индексов.

Какждый раз, когда вы создаете индекс, SQLite создает Б-дерево для хранения данных индекса.

Индекс содержит данные из столбца, который вы указали при в индексе, и соответствующий `rowid`. Это помогает SQLite быстро находить строку, основываясь на значении индексированного столбца.

Думайте о индексе в БД как об индексе в книге или запискной книжке. Использую индекс вы можете быстро искать страницу кники основываясь на ключевом слове.

## Выражение SQLite `CREATE INDEX`

Для создания индекса используется выражение `CREATE INDEX` со следующим синтаксисом:

``````````````````````````````````` SQL
CREATE [UNIQUE] INDEX index_name
ON table_name(column_list);
```````````````````````````````````````

Для создания индекса укажите следующую информацию:

- Название индекса после ключевого слова `CREATE INDEX`

- Название таблицы, которой принадлежит индекс

- Список столбцов индекса

В случае, если вы хотите убедится в том, что один или несколько столбцов являются уникальными, такие как телефон или e-mail, используйте опцию `UNIQUE` в выражении. `CREATE UNIQUE INDEX` создаст новый уникальный индекс.

## Пример SQLite `UNIQUE`

Давайте создадим новую таблицу `contacts` для демонстрации:

``````````````````````````````````` SQL
CREATE TABLE contacts (
  firstName TEXT NOT NULL,
  lastName TEXT NOT NULL,
  email TEXT NOT NULL
);
```````````````````````````````````````

Предположим, вы хотите указать, что почта должна быть уникальной, для этого вы должны создать уникальный индекс, как показано ниже:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CREATE UNIQUE INDEX idx_contacts_email
ON contacts (email);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для того, чтобы протестировать это, выполним следующие шаги:

1. Вставим строку в таблицу:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INSERT INTO contacts (firstName, lastName, email)
VALUES('John','Doe','john.doe@sqlitetutorial.net');
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

2. Вставим другую строку с дубликатом `email`:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INSERT INTO contacts (firstName, lastName, email)
VALUES('Johny','Doe','john.doe@sqlitetutorial.net');
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SQLite выдаст ошибку, в которой говорится о том, что уникальный индекс был нарушен. Из-за того, что вы хотите вставить строку с повторной почтой, SQLite проверяет строку на уникальность по всей таблице.

Давайте вставим еще несколько строк в таблицу:

~~~ SQL ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INSERT INTO contacts (firstName, lastName, email)
VALUES('David','Brown','david.brown@sqlitetutorial.net'),
      ('Lisa','Smith','lisa.smith@sqlitetutorial.net');
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



---------------------------------------

Предидущее руководство < [SQLite DROP VIEW][prev]  
Следующее руководство > [SQLite INDEX FOR EXPRESSIONS][next]

[prev]: ../52_DropView/translate.md
[next]: ../54_IndexForExpressions/translate.md

[index]: SQLite-Index.png